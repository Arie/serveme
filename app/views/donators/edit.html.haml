- content_for(:title) { "Edit donator" }

.row
  .col-md-8.offset-md-2
    .card
      .card-header
        %h4.mb-0.text-white Edit Donator Expiration
      
      .card-body
        .alert.alert-info.mb-4
          .d-flex.align-items-center
            %img.rounded-circle.mr-3{src: @donator.user.steam_avatar_url(:medium), width: "60", height: "60", alt: @donator.user.nickname}
            .flex-grow-1
              %h5.mb-1.text-white= @donator.user.nickname
              .text-white
                User ##{@donator.user.id} â€¢ 
                - if @donator.expires_at
                  Currently expires: 
                  %strong= l(@donator.expires_at, format: :long)
                - else
                  %strong Never expires
        
        = simple_form_for(@donator, url: url_for(controller: "donators", action: "update"), html: { class: 'form' }) do |f|
          .mb-4
            = f.input :expires_at, as: :string, 
                      input_html: { value: @donator.expires_at && I18n.l(@donator.expires_at, format: :datepicker), 
                                   data: { "datepicker-format": "dd-mm-yyyy hh:ii", 
                                          "datepicker-nodefault": "false" } }, 
                      label: "New expiration date",
                      hint: "Leave empty for permanent donator status"
            
            %label.form-label.mt-3.text-white Quick duration presets
            .btn-group.btn-group-sm{role: "group"}
              %button.btn.btn-outline-light{type: "button", 
                                           onclick: "setExpirationFromNow(31)"}
                +1 month
              %button.btn.btn-outline-light{type: "button",
                                           onclick: "setExpirationFromNow(93)"}
                +3 months
              %button.btn.btn-outline-light{type: "button",
                                           onclick: "setExpirationFromNow(186)"}
                +6 months
              %button.btn.btn-outline-light{type: "button",
                                           onclick: "setExpirationFromNow(365)"}
                +1 year
              %button.btn.btn-outline-light{type: "button",
                                           onclick: "document.getElementById('group_user_expires_at').value = ''"}
                Never expires
          
          .d-flex.justify-content-between
            = link_to donators_path, class: "btn btn-secondary" do
              %i.fa.fa-times.me-2
              Cancel
            %button.btn.btn-primary{type: "submit"}
              %i.fa.fa-save.me-2
              Update Expiration

= render "datepicker_options"

:javascript
  function setExpirationFromNow(days) {
    const date = new Date();
    date.setDate(date.getDate() + days);
    
    const day = String(date.getDate()).padStart(2, '0');
    const month = String(date.getMonth() + 1).padStart(2, '0');
    const year = date.getFullYear();
    const hours = String(date.getHours()).padStart(2, '0');
    const minutes = String(date.getMinutes()).padStart(2, '0');
    
    const formattedDate = `${day}-${month}-${year} ${hours}:${minutes}`;
    document.getElementById('group_user_expires_at').value = formattedDate;
  }

